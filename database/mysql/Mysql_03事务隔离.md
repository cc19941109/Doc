# Mysql 事务隔离

## 概述

### 知识点

1. 事务隔离级别有哪些?



## 事务隔离

1. 读未提交：别人改数据的事务尚未提交，我在我的事务中也能读到。
2. 读已提交：别人改数据的事务已经提交，我在我的事务中才能读到。
3. 可重复读：别人改数据的事务已经提交，我在我的事务中也不去读。
4. 串行：我的事务尚未提交，别人就别想改数据

### 配置

通过 `transaction_isolation` 配置

### 事务隔离的实现

每条记录在更新的时候都会同时记录一条回滚操作。同一条记录在系统中可以存在多个版本，这就是数据库的多版本并发控制（MVCC）。

### autocommit

`autocommit=1` 即显式启动事务语句，begin或者start transaction,提交commit，回滚rollback；

`set autocommit=0`，该命令会把这个线程的自动提交关掉。这样只要执行一个select语句，事务就启动，并不会自动提交，直到主动执行commit或rollback或断开连接。

## 



## 疑问

1. `information_schema.innodb_trx` 这张表是做什么的 ?
   - `select * from information_schema.innodb_trx ;`
2. 为什么不建议使用长事务
   - 长事务意味着系统里面会存在很老的事务视图, 在这个事务未提交之前, 数据库里面它可能用到的回滚记录都必须保留, 这会导致大量的占用存储空间
   - 在开发过程中，尽可能的减小事务范围，少用长事务，如果无法避免，保证逻辑日志空间足够用，并且支持动态日志空间增长。监控`Innodb_trx`表，发现长事务报警。
3. MVCC 是什么, 怎么实现的?
4. `read-view` 读视图是什么 ? 
5. 回滚日志什么时候清除 ?
