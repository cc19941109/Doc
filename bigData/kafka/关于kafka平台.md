# 关于 kafka 平台

Apache Kafka 是消息引擎系统,也是一个分布式流处理平台

## 2018年4月8日

kafka 分享会

## 历史 

ETL,  


## kafka 能做什么

我们采集到的不仅仅是数据

1. 不仅仅是温度数据
2. 用户行为数据
3. 设备的优良情况
4. app 改进
5.  

## 搭建一个数据处理平台的意义

这个数据处理平台的意义,远比我们现在看到的要大的多.

## zookeeper 

### broker 注册

broker 会在 zookeeper  /brokers/ids/[id] 上注册一个临时节点,当服务器宕机后,对应的节点也就被删除了

### topics 注册

brokers/topics/[topic]

broker 服务器在启动之后,回到对应的 topic 节点下注册自己的 broker id

### 进行负载均衡

kafka 的生产者会对 zookeeper 上的一些事件进行监听(比如: 1. broker 的增加/减少 2.Topic 的新增/减少 3. Broker 和 topic 的关系变化)

### 消费者负载均衡

消费者分组,不同消费者分组消费自己特定的 topic 下面的消息,互不干扰.

### 消费分区和消费者的关系

对于每一个消费者分组, kafka 都会为其分配一个全局唯一的 groupid, 同一个消费组内部所有消费者都共享该 id.

对于每一个消费者,都有唯一的 Consumer id

在 kafka,规定了每个消息分区有且只能同时有一个消费者进行消息的消费.

### 关于 zookeeper 容灾

对于5台 zookeeper 服务器构成的集群,可以应对2台服务器宕机的情况.而 6台zookeeper服务器组成的集群,同样只能够挂掉2台.

这就是为什么要用奇数台 zookeeper 服务器组成集群了.

### 单点问题

在一个分布式的环境中,如果某一个组件出现故障,就会引起整个系统的可用性大大降低,甚至处于瘫痪状态,那么我们认为该组件存在单点问题.








